@model DOANLTWEB.Models.DonDatHang
@{
    ViewBag.Title = "Chi tiết đơn hàng";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div class="admin-header">
    <div class="container-fluid">
        <h1><i class="fas fa-file-invoice"></i> Chi tiết đơn hàng #@Model.MaDon</h1>
        <p class="mb-0">Thông tin chi tiết đơn hàng</p>
    </div>
</div>

<div class="container-fluid">
    <div class="row">
        <div class="col-md-8">
            <!-- Thông tin đơn hàng -->
            <div class="table-container">
                <h4><i class="fas fa-shopping-cart"></i> Sản phẩm trong đơn hàng</h4>

                @if (Model.ChiTietDonDHs != null && Model.ChiTietDonDHs.Any())
                {
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead class="table-dark">
                                <tr>
                                    <th>Mã sách</th>
                                    <th>Tên sách</th>
                                    <th>Số lượng</th>
                                    <th>Đơn giá</th>
                                    <th>Thành tiền</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var chiTiet in Model.ChiTietDonDHs)
                                {
                                    <tr>
                                        <td>@chiTiet.MaSach</td>
                                        <td>
                                            @if (chiTiet.Sach != null)
                                            {
                                                @chiTiet.Sach.TenSach
                                            }
                                            else
                                            {
                                                <span class="text-muted">Không tìm thấy thông tin sách</span>
                                            }
                                        </td>
                                        <td>@chiTiet.SoLuongCTDDH</td>
                                        <td>@string.Format("{0:N0}", chiTiet.DonGiaCTDDH) VNĐ</td>
                                        <td class="fw-bold text-success">
                                            @string.Format("{0:N0}", chiTiet.SoLuongCTDDH * chiTiet.DonGiaCTDDH) VNĐ
                                        </td>
                                    </tr>
                                }
                            </tbody>
                            <tfoot class="table-secondary">
                                <tr>
                                    <td colspan="4" class="text-end fw-bold">Tổng tiền:</td>
                                    <td class="fw-bold text-success fs-5">
                                        @string.Format("{0:N0}", Model.TongTien) VNĐ
                                    </td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                }
                else
                {
                    <div class="alert alert-warning text-center">
                        <i class="fas fa-exclamation-circle"></i>
                        Không có sản phẩm nào trong đơn hàng này.
                    </div>
                }
            </div>
        </div>

        <div class="col-md-4">
            <!-- Thông tin khách hàng -->
            <div class="table-container">
                <h4><i class="fas fa-user"></i> Thông tin khách hàng</h4>
                <div class="card">
                    <div class="card-body">
                        @if (Model.KhachHang != null)
                        {
                            <p><strong>Họ tên:</strong> @Model.KhachHang.HoTenKH</p>
                            <p><strong>Email:</strong> @Model.KhachHang.email</p>
                            <p><strong>SĐT:</strong> @Model.KhachHang.SDT</p>
                            <p><strong>Địa chỉ:</strong> @Model.KhachHang.DiaChiKH</p>
                        }
                        else
                        {
                            <p class="text-muted">Không tìm thấy thông tin khách hàng</p>
                        }
                    </div>
                </div>
            </div>

            <!-- Thông tin đơn hàng -->
            <div class="table-container mt-3">
                <h4><i class="fas fa-info-circle"></i> Thông tin đơn hàng</h4>
                <div class="card">
                    <div class="card-body">
                        <p><strong>Mã đơn:</strong> #@Model.MaDon</p>
                        <p><strong>Ngày đặt:</strong> @(Model.NgayDat?.ToString("dd/MM/yyyy") ?? "N/A")</p>
                        <p><strong>Phí ship:</strong> @string.Format("{0:N0}", Model.PhiShip) VNĐ</p>
                        <p><strong>Thuế VAT:</strong> @(Model.ThueVAT?.ToString("P") ?? "N/A")</p>
                        <p><strong>Tổng tiền:</strong> <span class="text-success fw-bold">@string.Format("{0:N0}", Model.TongTien) VNĐ</span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="mt-3">
        <a href="@Url.Action("QuanLyDonHang", "Admin")" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Quay lại danh sách đơn hàng
        </a>
    </div>
</div>